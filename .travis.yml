language: common-lisp
sudo: required
os:
  - linux
  - osx

env:
  - LISP=sbcl-bin
  - LISP=ccl-bin

matrix:
  include:
    - env: LISP=sbcl/1.4.15
      os: linux
  allow_failures:
    - env: LISP=sbcl-bin
      os: linux

install:
  - if [ "$TRAVIS_OS_NAME" = linux ]; then sudo apt-get install clang; fi
  - if [ "$TRAVIS_OS_NAME" = linux ]; then sudo apt-get install libedit-dev; else brew install libedit; fi
  - curl -L https://raw.githubusercontent.com/snmsts/roswell/release/scripts/install-for-ci.sh | sh

script:
  - make LISP='ros -s cffi-grovel run --'
  - echo -shcl-run-tests | ./shcl
